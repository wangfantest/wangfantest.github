---
title: "如何判断文件是否为易语言程序"
date: 2021-09-27
tags: ["易语言"]
categories: ["易语言"]
---

因为工作的原因，需要判断文件是否为易语言程序，这里稍微记录一下。

首先了解到易语言EXE程序大致上可以分为编译、独立编译、静态编译、黑月编译这几种。

#### 1、读取文件的版本信息

大部分易语言程序的文件说明和产品名称是固定的值。

![文件版本信息](/images/如何判断文件是否为易语言程序/001.png)

#### 2、读取程序资源中的MANIFEST数据

![程序资源](/images/如何判断文件是否为易语言程序/002.png)

判断其中是否含有E.App这个关键字。

这种做法的好处是静态判断，有些程序即便是加了一些稀奇古怪的壳(SE、VMP、SP等)，也依然可以检测出来。

缺点是可能无法检测一些感染了蠕虫病毒的易语言样本。

#### 3、判断xor eax,eax

已知易语言程序代码段第一句为xor eax,eax，所以可以利用它来进行快速检测。

优点是简单、快速。

缺点是只支持静态编译的程序，且部分程序即便是静态编译开头也不是xor eax,eax指令。

#### 4、特征码扫描

易语言程序有太多的特征码，这里就不详细说明了。

这个方法缺点是对于加了壳的程序，需要动态运行起来才能进行识别。

优点是支持一些被蠕虫病毒(例如Synaptics)感染的样本。

